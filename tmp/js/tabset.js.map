{"version":3,"file":"tabset.js","sourceRoot":"","sources":["../../src/ts/tabset.ts"],"names":[],"mappings":";AAAA,+BAA+B;AAC/B,EAAE;AACF,kEAAkE;AAClE,mEAAmE;AACnE,0CAA0C;AAC1C,EAAE;AACF,iDAAiD;AACjD,EAAE;AACF,sEAAsE;AACtE,oEAAoE;AACpE,2EAA2E;AAC3E,sEAAsE;AACtE,iCAAiC;AAEjC,SAAS,UAAU;IAEf,SAAS,iBAAiB,CAAC,UAAkB,EAAE,WAAmB;QAC9D,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;YAClD,MAAM,CAAC,gBAAgB,CAAC,YAAY,CAAC,CAAC,OAAO,CAAC,CAAC,CAAC,EAAE;gBAC9C,MAAM,KAAK,GAAG,CAAgB,CAAC;gBAC/B,IAAI,KAAK,CAAC,OAAO,CAAC,UAAU,KAAK,UAAU,EAAE;oBACzC,KAAK,CAAC,gBAAgB,CAAc,YAAY,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;wBAC5D,MAAM,IAAI,GAAG,GAAG,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;wBAC5C,IAAI,CAAC,IAAI,EAAE;4BACP,OAAO;yBACV;wBAED,MAAM,KAAK,GAAG,OAAO,CAAC,IAAI,CAAC,CAAC;wBAC5B,IAAI,CAAC,KAAK,EAAE;4BACR,OAAO;yBACV;wBAED,IAAI,GAAG,CAAC,OAAO,CAAC,WAAW,KAAK,WAAW,EAAE;4BACzC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;4BACvC,GAAG,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;4BAC9B,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;yBACnC;6BAAM;4BACH,GAAG,CAAC,eAAe,CAAC,YAAY,CAAC,CAAC;4BAClC,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;4BACjC,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;yBACpC;oBACL,CAAC,CAAC,CAAC;iBACN;YACL,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC;IAED,QAAQ,CAAC,gBAAgB,CAAC,SAAS,CAAC,CAAC,OAAO,CAAC,MAAM,CAAC,EAAE;QAClD,MAAM,KAAK,GAAG,MAAM,CAAC,aAAa,CAAc,YAAY,CAAC,CAAC;QAC9D,IAAI,CAAC,KAAK,EAAE;YACR,OAAO;SACV;QAED,MAAM,UAAU,GAAG,KAAK,CAAC,OAAO,CAAC,UAAU,CAAC;QAC5C,MAAM,MAAM,GAAG,MAAM,CAAC,gBAAgB,CAAc,iBAAiB,CAAC,CAAC;QAEvE,MAAM,IAAI,GAAkB,EAAE,CAAC;QAC/B,KAAK,CAAC,gBAAgB,CAAc,YAAY,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAC5D,IAAI,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;QACnB,CAAC,CAAC,CAAC;QAEH,MAAM,MAAM,GAAG,IAAI,MAAM,CAAC,IAAI,CAAC,CAAC;QAEhC,SAAS,WAAW,CAAC,GAAgB;YACjC,iBAAiB,EAAE,CAAC;YACpB,GAAG,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;YAC9B,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,MAAM,CAAC,CAAC;YAEvC,MAAM,EAAE,GAAG,GAAG,CAAC,YAAY,CAAC,YAAY,CAAC,CAAC;YAC1C,IAAI,EAAE,EAAE;gBACJ,MAAM,KAAK,GAAG,OAAO,CAAC,EAAE,CAAC,CAAC;gBAC1B,IAAI,KAAK,EAAE;oBACP,KAAK,CAAC,eAAe,CAAC,QAAQ,CAAC,CAAC;iBACnC;aACJ;QACL,CAAC;QAED,SAAS,iBAAiB;YACtB,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;gBACf,GAAG,CAAC,YAAY,CAAC,QAAQ,EAAE,IAAI,CAAC,CAAC;gBACjC,GAAG,CAAC,YAAY,CAAC,YAAY,EAAE,OAAO,CAAC,CAAC;YAC5C,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,OAAO,CAAC,KAAK,CAAC,EAAE;gBACnB,KAAK,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,CAAC,CAAC;YACrC,CAAC,CAAC,CAAC;QACP,CAAC;QAED,IAAI,UAAU,EAAE;YACZ,MAAM,WAAW,GAAG,UAAU,CAAC,UAAU,CAAC,CAAC;YAC3C,IAAI,WAAW,EAAE;gBACb,iBAAiB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;aAC9C;SACJ;QAED,gDAAgD;QAChD,KAAK,CAAC,gBAAgB,CAAc,MAAM,CAAC,CAAC,OAAO,CAAC,GAAG,CAAC,EAAE;YAEtD,MAAM,CAAC,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE;gBACtB,WAAW,CAAC,GAAG,CAAC,CAAC;gBAEjB,IAAI,UAAU,EAAE;oBACZ,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC;oBAC5C,IAAI,WAAW,EAAE;wBACb,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;wBACtC,iBAAiB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;qBAC9C;iBACJ;YACL,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,OAAO,EAAE,GAAG,EAAE;gBACtB,WAAW,CAAC,GAAG,CAAC,CAAC;gBAEjB,IAAI,UAAU,EAAE;oBACZ,MAAM,WAAW,GAAG,GAAG,CAAC,OAAO,CAAC,WAAW,CAAC;oBAC5C,IAAI,WAAW,EAAE;wBACb,YAAY,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;wBACtC,iBAAiB,CAAC,UAAU,EAAE,WAAW,CAAC,CAAC;qBAC9C;iBACJ;YACL,CAAC,CAAC,CAAC;YAEH,MAAM,CAAC,GAAG,EAAE,OAAO,EAAE,CAAC,CAAC,EAAE;gBACrB,MAAM,CAAC,GAAG,CAAkB,CAAC;gBAC7B,MAAM,EAAE,GAAG,CAAC,CAAC,GAAG,CAAC;gBAEjB,IAAI,CAAC,CAAC,OAAO,IAAI,CAAC,CAAC,MAAM,IAAI,CAAC,CAAC,OAAO,EAAE;oBACpC,UAAU;iBACb;qBAAM,IAAI,CAAC,CAAC,QAAQ,EAAE;oBACnB,IAAI,oBAAoB,CAAC,EAAE,CAAC,EAAE;wBAC1B,MAAM,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;qBACjC;iBACJ;qBAAM;oBACH,QAAQ,CAAC,CAAC,OAAO,EAAE;wBACf,KAAK,QAAQ,CAAC,IAAI;4BACd,MAAM,CAAC,gBAAgB,EAAE,CAAC;4BAC1B,MAAM;wBAEV,KAAK,QAAQ,CAAC,KAAK;4BACf,MAAM,CAAC,gBAAgB,EAAE,CAAC;4BAC1B,MAAM;wBAEV,KAAK,QAAQ,CAAC,IAAI;4BACd,MAAM,CAAC,iBAAiB,EAAE,CAAC;4BAC3B,MAAM;wBAEV,KAAK,QAAQ,CAAC,GAAG;4BACb,MAAM,CAAC,gBAAgB,EAAE,CAAC;4BAC1B,MAAM;wBAEV,KAAK,QAAQ,CAAC,GAAG;4BACb,OAAO;wBAEX;4BACI,IAAI,oBAAoB,CAAC,EAAE,CAAC,EAAE;gCAC1B,MAAM,CAAC,kBAAkB,CAAC,EAAE,CAAC,CAAC;6BACjC;4BACD,MAAM;qBACb;oBACD,CAAC,CAAC,cAAc,EAAE,CAAC;oBACnB,CAAC,CAAC,YAAY,GAAG,IAAI,CAAC;iBACzB;YACL,CAAC,CAAC,CAAC;QACP,CAAC,CAAC,CAAC;IACP,CAAC,CAAC,CAAC;AACP,CAAC;AAED,UAAU,EAAE,CAAC","sourcesContent":["// Copyright 2019 Istio Authors\n//\n// Licensed under the Apache License, Version 2.0 (the \"License\");\n// you may not use this file except in compliance with the License.\n// You may obtain a copy of the License at\n//\n//     http://www.apache.org/licenses/LICENSE-2.0\n//\n// Unless required by applicable law or agreed to in writing, software\n// distributed under the License is distributed on an \"AS IS\" BASIS,\n// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n// See the License for the specific language governing permissions and\n// limitations under the License.\n\nfunction handleTabs(): void {\n\n    function updateLikeTabsets(cookieName: string, cookieValue: string): void {\n        document.querySelectorAll(\".tabset\").forEach(tabset => {\n            tabset.querySelectorAll(\".tab-strip\").forEach(o => {\n                const strip = o as HTMLElement;\n                if (strip.dataset.cookieName === cookieName) {\n                    strip.querySelectorAll<HTMLElement>(\"[role=tab]\").forEach(tab => {\n                        const attr = tab.getAttribute(ariaControls);\n                        if (!attr) {\n                            return;\n                        }\n\n                        const panel = getById(attr);\n                        if (!panel) {\n                            return;\n                        }\n\n                        if (tab.dataset.cookieValue === cookieValue) {\n                            tab.setAttribute(ariaSelected, \"true\");\n                            tab.removeAttribute(tabIndex);\n                            panel.removeAttribute(\"hidden\");\n                        } else {\n                            tab.removeAttribute(ariaSelected);\n                            tab.setAttribute(tabIndex, \"-1\");\n                            panel.setAttribute(\"hidden\", \"\");\n                        }\n                    });\n                }\n            });\n        });\n    }\n\n    document.querySelectorAll(\".tabset\").forEach(tabset => {\n        const strip = tabset.querySelector<HTMLElement>(\".tab-strip\");\n        if (!strip) {\n            return;\n        }\n\n        const cookieName = strip.dataset.cookieName;\n        const panels = tabset.querySelectorAll<HTMLElement>(\"[role=tabpanel]\");\n\n        const tabs: HTMLElement[] = [];\n        strip.querySelectorAll<HTMLElement>(\"[role=tab]\").forEach(tab => {\n            tabs.push(tab);\n        });\n\n        const kbdnav = new KbdNav(tabs);\n\n        function activateTab(tab: HTMLElement): void {\n            deactivateAllTabs();\n            tab.removeAttribute(tabIndex);\n            tab.setAttribute(ariaSelected, \"true\");\n\n            const ac = tab.getAttribute(ariaControls);\n            if (ac) {\n                const other = getById(ac);\n                if (other) {\n                    other.removeAttribute(\"hidden\");\n                }\n            }\n        }\n\n        function deactivateAllTabs(): void {\n            tabs.forEach(tab => {\n                tab.setAttribute(tabIndex, \"-1\");\n                tab.setAttribute(ariaSelected, \"false\");\n            });\n\n            panels.forEach(panel => {\n                panel.setAttribute(\"hidden\", \"\");\n            });\n        }\n\n        if (cookieName) {\n            const cookieValue = readCookie(cookieName);\n            if (cookieValue) {\n                updateLikeTabsets(cookieName, cookieValue);\n            }\n        }\n\n        // attach the event handlers to support tab sets\n        strip.querySelectorAll<HTMLElement>(button).forEach(tab => {\n\n            listen(tab, \"focus\", () => {\n                activateTab(tab);\n\n                if (cookieName) {\n                    const cookieValue = tab.dataset.cookieValue;\n                    if (cookieValue) {\n                        createCookie(cookieName, cookieValue);\n                        updateLikeTabsets(cookieName, cookieValue);\n                    }\n                }\n            });\n\n            listen(tab, \"click\", () => {\n                activateTab(tab);\n\n                if (cookieName) {\n                    const cookieValue = tab.dataset.cookieValue;\n                    if (cookieValue) {\n                        createCookie(cookieName, cookieValue);\n                        updateLikeTabsets(cookieName, cookieValue);\n                    }\n                }\n            });\n\n            listen(tab, keydown, o => {\n                const e = o as KeyboardEvent;\n                const ch = e.key;\n\n                if (e.ctrlKey || e.altKey || e.metaKey) {\n                    // nothing\n                } else if (e.shiftKey) {\n                    if (isPrintableCharacter(ch)) {\n                        kbdnav.focusElementByChar(ch);\n                    }\n                } else {\n                    switch (e.keyCode) {\n                        case keyCodes.LEFT:\n                            kbdnav.focusPrevElement();\n                            break;\n\n                        case keyCodes.RIGHT:\n                            kbdnav.focusNextElement();\n                            break;\n\n                        case keyCodes.HOME:\n                            kbdnav.focusFirstElement();\n                            break;\n\n                        case keyCodes.END:\n                            kbdnav.focusLastElement();\n                            break;\n\n                        case keyCodes.TAB:\n                            return;\n\n                        default:\n                            if (isPrintableCharacter(ch)) {\n                                kbdnav.focusElementByChar(ch);\n                            }\n                            break;\n                    }\n                    e.preventDefault();\n                    e.cancelBubble = true;\n                }\n            });\n        });\n    });\n}\n\nhandleTabs();\n"]}